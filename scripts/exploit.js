const hre = require("hardhat");
const { ONE_ETHER } = require("../test/constant");

async function main() {
  const GuessTheNumber = await hre.ethers.getContractFactory("GuessTheNumber");
  const guessthenumber = await GuessTheNumber.deploy(2);
  const [ ALICE, BOB, CHARLIE ] = await hre.ethers.getSigners();

  await guessthenumber.deployed();
  console.log("GuessTheNumber deployed to:", guessthenumber.address);

  console.log(`########################################`);
  for (i = 0; i <= 10; i++) {
    console.log(`ðŸ§‘ BOB guess ${i} for 1 ether`)
    await guessthenumber.connect(BOB).guess(i, {value: ONE_ETHER});
    console.log(`ðŸ‘¨ CHARLIE guess ${i} for 1 ether`)
    await guessthenumber.connect(CHARLIE).guess(i, {value: ONE_ETHER});
  }
  console.log(`########################################`);

  console.log("contract address balance: ",hre.ethers.utils.formatEther(await guessthenumber.getValue()));
  console.log("ðŸ˜ˆ ALICE balance before kill contract: ", hre.ethers.utils.formatEther((await ALICE.getBalance())));
  await guessthenumber.connect(ALICE).kill();

  console.log("ðŸ˜ˆ ALICE balance after kill contract: ", hre.ethers.utils.formatEther((await ALICE.getBalance())));
}

main().catch((error) => {
  console.error(error);
  process.exitCode = 1;
});
